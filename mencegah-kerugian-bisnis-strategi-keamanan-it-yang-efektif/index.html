<!DOCTYPE html><html lang="en-us"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Mencegah Kerugian Bisnis: Strategi Keamanan IT yang Efektif untuk Era Digital - Primavera Siber Indonesia</title><meta name="description" content="Di era digital yang serba cepat dan terhubung, keamanan informasi bukan lagi sekadar isu teknis—melainkan fondasi utama kelangsungan bisnis. Satu celah kecil dalam sistem IT dapat berujung pada kerugian finansial, rusaknya reputasi, dan hilangnya kepercayaan pelanggan. Maka dari itu, pendekatan strategis dan menyeluruh terhadap keamanan&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://www.siberin.my.id/mencegah-kerugian-bisnis-strategi-keamanan-it-yang-efektif/"><link rel="alternate" type="application/atom+xml" href="https://www.siberin.my.id/feed.xml" title="Primavera Siber Indonesia - RSS"><link rel="alternate" type="application/json" href="https://www.siberin.my.id/feed.json" title="Primavera Siber Indonesia - JSON"><meta property="og:title" content="Mencegah Kerugian Bisnis: Strategi Keamanan IT yang Efektif untuk Era Digital"><meta property="og:site_name" content="Primavera Siber Indonesia"><meta property="og:description" content="Di era digital yang serba cepat dan terhubung, keamanan informasi bukan lagi sekadar isu teknis—melainkan fondasi utama kelangsungan bisnis. Satu celah kecil dalam sistem IT dapat berujung pada kerugian finansial, rusaknya reputasi, dan hilangnya kepercayaan pelanggan. Maka dari itu, pendekatan strategis dan menyeluruh terhadap keamanan&hellip;"><meta property="og:url" content="https://www.siberin.my.id/mencegah-kerugian-bisnis-strategi-keamanan-it-yang-efektif/"><meta property="og:type" content="article"><link rel="stylesheet" href="https://www.siberin.my.id/assets/css/style.css?v=483478d416d1584943ca5d65c78b7dfa"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.siberin.my.id/mencegah-kerugian-bisnis-strategi-keamanan-it-yang-efektif/"},"headline":"Mencegah Kerugian Bisnis: Strategi Keamanan IT yang Efektif untuk Era Digital","datePublished":"2025-07-24T18:16+07:00","dateModified":"2025-07-28T12:27+07:00","description":"Di era digital yang serba cepat dan terhubung, keamanan informasi bukan lagi sekadar isu teknis—melainkan fondasi utama kelangsungan bisnis. Satu celah kecil dalam sistem IT dapat berujung pada kerugian finansial, rusaknya reputasi, dan hilangnya kepercayaan pelanggan. Maka dari itu, pendekatan strategis dan menyeluruh terhadap keamanan&hellip;","author":{"@type":"Person","name":"Franky Setiawan","url":"https://www.siberin.my.id/authors/franky-setiawan/"},"publisher":{"@type":"Organization","name":"Franky Setiawan"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body class="post-template"><header class="top js-header"><a class="logo" href="https://www.siberin.my.id/">Primavera Siber Indonesia</a></header><main class="post"><article class="content"><div class="hero hero--noimage"><header class="hero__content"><div class="wrapper"><h1>Mencegah Kerugian Bisnis: Strategi Keamanan IT yang Efektif untuk Era Digital</h1><div class="feed__meta content__meta"><a href="https://www.siberin.my.id/authors/franky-setiawan/" class="feed__author">Franky Setiawan</a> <time datetime="2025-07-24T18:16" class="feed__date">July 24, 2025</time></div></div></header></div><div class="entry-wrapper content__entry"><p data-start="244" data-end="623">Di era digital yang serba cepat dan terhubung, keamanan informasi bukan lagi sekadar isu teknis—melainkan fondasi utama kelangsungan bisnis. Satu celah kecil dalam sistem IT dapat berujung pada kerugian finansial, rusaknya reputasi, dan hilangnya kepercayaan pelanggan. Maka dari itu, pendekatan strategis dan menyeluruh terhadap keamanan dan manajemen IT menjadi sangat krusial.</p><p data-start="625" data-end="815">Sebagai firma yang fokus pada layanan keamanan siber dan kepatuhan ISO 27001, kami percaya bahwa keamanan bukan hanya tentang teknologi, tetapi juga proses, kebijakan, dan budaya organisasi.</p><hr data-start="817" data-end="820"><h3 data-start="822" data-end="862"><strong data-start="826" data-end="862">Ancaman Nyata bagi Bisnis Modern</strong></h3><p data-start="864" data-end="941">Organisasi saat ini menghadapi beragam risiko keamanan yang semakin kompleks:</p><ul data-start="943" data-end="1632"><li data-start="943" data-end="1109"><p data-start="945" data-end="1109"><strong data-start="945" data-end="963">Serangan Siber</strong>: Peretasan, malware, ransomware, dan phishing kini menjadi ancaman harian. Serangan ini bisa melumpuhkan sistem operasional dalam hitungan menit.</p></li><li data-start="1110" data-end="1279"><p data-start="1112" data-end="1279"><strong data-start="1112" data-end="1130">Kebocoran Data</strong>: Hilangnya data pelanggan atau informasi internal dapat mengundang sanksi hukum dan menghancurkan reputasi brand yang telah dibangun bertahun-tahun.</p></li><li data-start="1280" data-end="1442"><p data-start="1282" data-end="1442"><strong data-start="1282" data-end="1301">Downtime Sistem</strong>: Gangguan akibat kegagalan infrastruktur IT dapat menyebabkan kerugian besar, terutama bagi bisnis yang bergantung pada operasional digital.</p></li><li data-start="1443" data-end="1632"><p data-start="1445" data-end="1632"><strong data-start="1445" data-end="1467">Kepatuhan Regulasi</strong>: Aturan seperti ISO 27001, GDPR, HIPAA, dan PP No. 71/2019 di Indonesia memerlukan kepatuhan ketat dan audit berkala, yang menuntut kesiapan dokumentasi dan sistem.</p></li></ul><hr data-start="1634" data-end="1637"><h3 data-start="1639" data-end="1708"><strong data-start="1643" data-end="1708">Pendekatan Konsultatif: Investasi Perlindungan Jangka Panjang</strong></h3><p data-start="1710" data-end="1948">Banyak bisnis berupaya menangani tantangan ini sendiri, namun realitanya, pendekatan internal seringkali tidak cukup. Dibutuhkan perspektif eksternal yang objektif dan berpengalaman. Di sinilah pendekatan konsultatif kami menjadi pembeda.</p><h4 data-start="1950" data-end="1992"><strong data-start="1955" data-end="1992">Layanan Kunci yang Kami Tawarkan:</strong></h4><ul data-start="1994" data-end="2882"><li data-start="1994" data-end="2178"><p data-start="1996" data-end="2178"><strong data-start="1996" data-end="2029">Assessment &amp; Roadmap Keamanan</strong><br data-start="2029" data-end="2032">Identifikasi risiko dan celah keamanan melalui audit menyeluruh, serta susun strategi bertahap menuju sistem yang lebih aman dan patuh regulasi.</p></li><li data-start="2180" data-end="2345"><p data-start="2182" data-end="2345"><strong data-start="2182" data-end="2215">Penetration Testing (Pentest)</strong><br data-start="2215" data-end="2218">Uji coba sistem Anda secara ofensif untuk mengetahui titik rawan sebelum pihak tak bertanggung jawab menemukannya lebih dulu.</p></li><li data-start="2347" data-end="2495"><p data-start="2349" data-end="2495"><strong data-start="2349" data-end="2384">Security Operation Center (SOC)</strong><br data-start="2384" data-end="2387">Pemantauan dan respons insiden 24/7 oleh tim ahli kami untuk memastikan ancaman ditangani secepat mungkin.</p></li><li data-start="2497" data-end="2691"><p data-start="2499" data-end="2691"><strong data-start="2499" data-end="2524">Sertifikasi ISO 27001</strong><br data-start="2524" data-end="2527">Bimbingan menyeluruh mulai dari gap analysis, dokumentasi ISMS, hingga pendampingan audit eksternal agar Anda meraih sertifikasi dengan efisien dan tepat sasaran.</p></li><li data-start="2693" data-end="2882"><p data-start="2695" data-end="2882"><strong data-start="2695" data-end="2732">Virtual IT &amp; Compliance Assistant</strong><br data-start="2732" data-end="2735">Bantuan administratif untuk kelola dokumentasi, compliance tracker, hingga pengingat audit—semua dikawal oleh sistem dan tim yang paham keamanan.</p></li></ul><hr data-start="2884" data-end="2887"><h3 data-start="2889" data-end="2919"><strong data-start="2893" data-end="2917">Studi Kasus (Anonim)</strong></h3><p data-start="2920" data-end="3272">Salah satu klien kami di sektor e-commerce mengalami gelombang serangan DDoS pasca migrasi sistem. Melalui layanan pentesting dan tuning konfigurasi yang kami berikan, potensi downtime dapat ditekan hingga 80%. Klien pun melanjutkan proses sertifikasi ISO 27001 dengan lebih percaya diri karena risiko telah dipetakan dan ditanggulangi secara proaktif.</p><hr data-start="3274" data-end="3277"><h3 data-start="3279" data-end="3332"><strong data-start="3283" data-end="3332">Siap Membangun Pertahanan Siber yang Tangguh?</strong></h3><p data-start="3334" data-end="3535">Keamanan tidak dapat ditunda, dan pendekatan reaktif bukan lagi pilihan. Membangun sistem IT yang aman, patuh, dan efisien adalah investasi yang memberikan perlindungan sekaligus keunggulan kompetitif.</p><p data-start="3537" data-end="3786">📩 <strong data-start="3540" data-end="3561">Konsultasi gratis</strong> bersama tim ahli kami tersedia untuk bisnis yang ingin memulai transformasi keamanan secara serius.</p><hr data-start="3788" data-end="3791"><h3 data-start="3793" data-end="3815"><strong data-start="3797" data-end="3813">Tentang Kami</strong></h3><p data-start="3816" data-end="4087">PT Primavera Siber Indonesia adalah mitra terpercaya dalam membangun sistem keamanan informasi dan sertifikasi ISO 27001. Kami telah membantu berbagai organisasi, dari skala startup hingga enterprise, mengamankan aset digital dan mencapai kepatuhan dengan standar global.</p><hr data-start="4089" data-end="4092"><p data-start="4094" data-end="4248"><strong data-start="4094" data-end="4166">Jangan tunggu sampai insiden terjadi. Lindungi bisnis Anda hari ini.</strong><br data-start="4166" data-end="4169">Hubungi kami untuk memulai percakapan strategis seputar keamanan dan kepatuhan.</p><p data-start="4127" data-end="4278">📩 <strong data-start="4130" data-end="4189">Hubungi kami untuk asesmen awal atau konsultasi gratis.</strong><br data-start="4189" data-end="4192">📘 <em data-start="4195" data-end="4216">Unduh panduan kami:</em> “<a href="https://www.siberin.my.id/🎯 Ransomware Readiness_ Membangun Ketahanan Siber Bisnis Anda.pdf" target="_blank" rel="noopener noreferrer">Ransomware Readiness: Membangun Ketahanan Siber Bisnis Anda</a>”</p><hr data-start="4280" data-end="4283"><p data-start="4285" data-end="4349"><strong data-start="4285" data-end="4349">PT Primavera Siber Indonesia – Keamanan Anda, Komitmen Kami.</strong></p><h3 data-start="4330" data-end="4349">📞 Hubungi Kami</h3><p data-start="4351" data-end="4430"><strong data-start="4351" data-end="4383">PT Primavera Siber Indonesia</strong><br data-start="4383" data-end="4386"><em data-start="4386" data-end="4430">Konsultan Keamanan &amp; Sertifikasi ISO 27001</em></p><p data-start="4432" data-end="4572">📧 Email: <a data-start="4442" data-end="4464" class="cursor-pointer" rel="noopener">info@primaverasiber.id</a><br data-start="4464" data-end="4467">🌐 Web: <a data-start="4475" data-end="4528" class="cursor-pointer" rel="noopener" target="_new">www.primaverasiber.id</a><br data-start="4528" data-end="4531">📞 Konsultasi Gratis: +62-817-1717-9080</p></div><footer class="content__footer"><div class="entry-wrapper"><p class="content__updated">This article was updated on July 28, 2025</p><div class="content__actions"><div class="content__share"><button class="btn--icon content__share-button js-content__share-button"><svg width="20" height="20" aria-hidden="true"><use xlink:href="https://www.siberin.my.id/assets/svg/svg-map.svg#share"></use></svg> <span>Share It</span></button><div class="content__share-popup js-content__share-popup"></div></div></div><div class="content__bio bio"><div><h3 class="h4 bio__name"><a href="https://www.siberin.my.id/authors/franky-setiawan/" rel="author">Franky Setiawan</a></h3></div></div></div><nav class="content__nav"><div class="wrapper"><div class="content__nav-inner"><div class="content__nav-next"><a href="https://www.siberin.my.id/ransomware-dan-security-posture-cermin-ketahanan-keamanan-perusahaan-anda/" class="content__nav-link" rel="next"><div><span>Next</span> Ransomware dan Security Posture: Cermin Ketahanan Keamanan Perusahaan Anda</div></a></div></div></div></nav></footer></article><div class="content__related related"><div class="wrapper"><h2 class="h4 related__title">You should also read:</h2><article class="feed__item feed__item--centered"><div class="feed__content"><header><div class="feed__meta"><a href="https://www.siberin.my.id/authors/franky-setiawan/" class="feed__author">Franky Setiawan</a> <time datetime="2025-07-28T12:12" class="feed__date">July 28, 2025</time></div><h3 class="feed__title"><a href="https://www.siberin.my.id/ransomware-dan-security-posture-cermin-ketahanan-keamanan-perusahaan-anda/">Ransomware dan Security Posture: Cermin Ketahanan Keamanan Perusahaan Anda</a></h3></header><p>Di tengah meningkatnya serangan siber, ransomware telah menjadi ancaman yang paling mengganggu stabilitas operasional bisnis. Namun, dampak ransomware tidak hanya bergantung pada tingkat ancamannya—tetapi juga sangat ditentukan oleh security posture perusahaan yang diserang. Artikel ini akan mengulas bagaimana kondisi kesiapan keamanan (security posture) perusahaan mempengaruhi&hellip;</p><a href="https://www.siberin.my.id/ransomware-dan-security-posture-cermin-ketahanan-keamanan-perusahaan-anda/" class="readmore feed__readmore">Continue reading...</a></div></article></div></div></main><footer class="footer footer--glued"><div class="wrapper"><div class="footer__copyright">Powered by Publii</div><button id="backToTop" class="footer__bttop" aria-label="Back to top" title="Back to top"><svg width="20" height="20"><use xlink:href="https://www.siberin.my.id/assets/svg/svg-map.svg#toparrow"/></svg></button></div></footer><script defer="defer" src="https://www.siberin.my.id/assets/js/scripts.min.js?v=ffcbea6c02c8178d10092962b235a5b0"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script><div class="pcb" data-behaviour="badge" data-behaviour-link="#cookie-settings" data-revision="1" data-config-ttl="90" data-debug-mode="false"><div role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="pcb-title" aria-describedby="pcb-txt" class="pcb__banner"><div class="pcb__inner"><div id="pcb-title" role="heading" aria-level="2" class="pcb__title">This website uses cookies</div><div id="pcb-txt" class="pcb__txt">Select which cookies to opt-in to via the checkboxes below; our website uses cookies to examine site traffic and user activity while on our site, for marketing, and to provide social media functionality.</div><div class="pcb__buttons"><button type="button" class="pcb__btn pcb__btn--link pcb__btn--configure" aria-haspopup="dialog">Manage preferences</button> <button type="button" class="pcb__btn pcb__btn--solid pcb__btn--accept">Accept all</button></div></div></div><div class="pcb__popup" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="pcb-popup-title"><div class="pcb__popup__wrapper"><div class="pcb__inner pcb__popup__inner"><div class="pcb__popup__heading"><div id="pcb-popup-title" role="heading" aria-level="2" class="pcb__title">Cookie settings</div><button class="pcb__popup__close" aria-label="Close"></button></div><div class="pcb__popup__content"><div class="pcb__txt pcb__popup__txt">We use cookies to enhance your browsing experience, serve personalized ads or content, and analyze our traffic. By clicking "Accept All", you consent to our use of cookies.</div><ul class="pcb__groups"><li class="pcb__group"><details><summary class="pcb__group__title no-desc">Required</summary></details><div class="pcb__popup__switch is-checked"><input type="checkbox" data-group-name="" id="pcb-group-0" checked="checked"> <label for="pcb-group-0">Required</label></div></li></ul></div><div class="pcb__buttons pcb__popup__buttons"><button type="button" class="pcb__btn pcb__btn--solid pcb__btn--accept">Accept all</button> <button type="button" class="pcb__btn pcb__btn--reject">Reject all</button> <button type="button" class="pcb__btn pcb__btn--save">Save settings</button></div></div></div></div><div class="pcb__overlay" aria-hidden="true"></div><button class="pcb__badge" aria-label="Cookie Policy" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" width="40" height="40" viewBox="0 0 23 23" fill="currentColor"><path d="M21.41 12.71c-.08-.01-.15 0-.22 0h-.03c-.03 0-.05 0-.08.01-.07 0-.13.01-.19.04-.52.21-1.44.19-2.02-.22-.44-.31-.65-.83-.62-1.53a.758.758 0 0 0-.27-.61.73.73 0 0 0-.65-.14c-1.98.51-3.49.23-4.26-.78-.82-1.08-.73-2.89.24-4.49.14-.23.14-.52 0-.75a.756.756 0 0 0-.67-.36c-.64.03-1.11-.1-1.31-.35-.19-.26-.13-.71-.01-1.29.04-.18.06-.38.03-.59-.05-.4-.4-.7-.81-.66C5.1 1.54 1 6.04 1 11.48 1 17.28 5.75 22 11.6 22c5.02 0 9.39-3.54 10.39-8.42.08-.4-.18-.78-.58-.87Zm-9.81 7.82c-5.03 0-9.12-4.06-9.12-9.06 0-4.34 3.05-8 7.25-8.86-.08.7.05 1.33.42 1.81.24.32.66.67 1.38.84-.76 1.86-.65 3.78.36 5.11.61.81 2.03 2 4.95 1.51.18.96.71 1.54 1.18 1.87.62.43 1.38.62 2.1.62.05 0 .09 0 .13-.01-1.23 3.64-4.7 6.18-8.64 6.18ZM13 17c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1Zm5.29-12.3a.99.99 0 0 1-.29-.71c0-.55.45-.99 1-.99a1 1 0 0 1 .71.3c.19.19.29.44.29.71 0 .55-.45.99-1 .99a1 1 0 0 1-.71-.3ZM9 13.5c0 .83-.67 1.5-1.5 1.5S6 14.33 6 13.5 6.67 12 7.5 12s1.5.67 1.5 1.5Zm3.25.81a.744.744 0 0 1-.06-1.05c.28-.32.75-.34 1.05-.06.31.28.33.75.05 1.06-.15.16-.35.25-.56.25-.18 0-.36-.06-.5-.19ZM8.68 7.26c.41.37.44 1 .07 1.41-.2.22-.47.33-.75.33a.96.96 0 0 1-.67-.26c-.41-.37-.44-1-.07-1.41.37-.42 1-.45 1.41-.08Zm11.48 1.88c.18-.19.52-.19.7 0 .05.04.09.1.11.16.03.06.04.12.04.19 0 .13-.05.26-.15.35-.09.1-.22.15-.35.15s-.26-.05-.35-.15a.355.355 0 0 1-.11-.16.433.433 0 0 1-.04-.19c0-.13.05-.26.15-.35Zm-4.93-1.86a.75.75 0 1 1 1.059-1.06.75.75 0 0 1-1.059 1.06Z"/></svg></button></div><script>(function(win) {
    if (!document.querySelector('.pcb')) {
        return;
    }

    var cbConfig = {
        behaviour: document.querySelector('.pcb').getAttribute('data-behaviour'),
        behaviourLink: document.querySelector('.pcb').getAttribute('data-behaviour-link'),
        revision: document.querySelector('.pcb').getAttribute('data-revision'),
        configTTL: parseInt(document.querySelector('.pcb').getAttribute('data-config-ttl'), 10),
        debugMode: document.querySelector('.pcb').getAttribute('data-debug-mode') === 'true',
        initialState: null,
        initialLsState: null,
        previouslyAccepted: []
    };

    var cbUI = {
        wrapper: document.querySelector('.pcb'),
        banner: {
            element: null,
            btnAccept: null,
            btnReject: null,
            btnConfigure: null
        },
        popup: {
            element: null,
            btnClose: null,
            btnSave: null,
            btnAccept: null,
            btnReject: null,
            checkboxes: null,
        },
        overlay: null,
        badge: null,
        blockedScripts: document.querySelectorAll('script[type^="gdpr-blocker/"]'),
        triggerLinks: cbConfig.behaviourLink ? document.querySelectorAll('a[href*="' + cbConfig.behaviourLink + '"]') : null
    };

    function initUI () {
        // setup banner elements
        cbUI.banner.element = cbUI.wrapper.querySelector('.pcb__banner');
        cbUI.banner.btnAccept = cbUI.banner.element.querySelector('.pcb__btn--accept');
        cbUI.banner.btnReject = cbUI.banner.element.querySelector('.pcb__btn--reject');
        cbUI.banner.btnConfigure = cbUI.banner.element.querySelector('.pcb__btn--configure');

        // setup popup elements
        if (cbUI.wrapper.querySelector('.pcb__popup')) {
            cbUI.popup.element = cbUI.wrapper.querySelector('.pcb__popup');
            cbUI.popup.btnClose = cbUI.wrapper.querySelector('.pcb__popup__close');
            cbUI.popup.btnSave = cbUI.popup.element.querySelector('.pcb__btn--save');
            cbUI.popup.btnAccept = cbUI.popup.element.querySelector('.pcb__btn--accept');
            cbUI.popup.btnReject = cbUI.popup.element.querySelector('.pcb__btn--reject');
            cbUI.popup.checkboxes = cbUI.popup.element.querySelector('input[type="checkbox"]');
            // setup overlay
            cbUI.overlay = cbUI.wrapper.querySelector('.pcb__overlay');
        }

        cbUI.badge = cbUI.wrapper.querySelector('.pcb__badge');

        if (cbConfig.behaviour.indexOf('link') > -1) {
            for (var i = 0; i < cbUI.triggerLinks.length; i++) {
                cbUI.triggerLinks[i].addEventListener('click', function(e) {
                    e.preventDefault();
                    showBannerOrPopup();
                });
            }
        }
    }

    function initState () {
        var lsKeyName = getConfigName();
        var currentConfig = localStorage.getItem(lsKeyName);
        var configIsFresh = checkIfConfigIsFresh();

        if (!configIsFresh || currentConfig === null) {
            if (cbConfig.debugMode) {
                console.log('🍪 Config not found, or configuration expired');
            }

            if (window.publiiCBGCM) {
                gtag('consent', 'default', {
                    'ad_storage': window.publiiCBGCM.defaultState.ad_storage ? 'granted' : 'denied',
                    'ad_personalization': window.publiiCBGCM.defaultState.ad_personalization ? 'granted' : 'denied',
                    'ad_user_data': window.publiiCBGCM.defaultState.ad_user_data ? 'granted' : 'denied',
                    'analytics_storage': window.publiiCBGCM.defaultState.analytics_storage ? 'granted' : 'denied',
                    'personalization_storage': window.publiiCBGCM.defaultState.personalization_storage ? 'granted' : 'denied',
                    'functionality_storage': window.publiiCBGCM.defaultState.functionality_storage ? 'granted' : 'denied',
                    'security_storage': window.publiiCBGCM.defaultState.security_storage ? 'granted' : 'denied'
                });  
                
                if (cbConfig.debugMode) {
                    console.log('🍪 GCMv2 DEFAULT STATE: ' + JSON.stringify({
                        'ad_storage': window.publiiCBGCM.defaultState.ad_storage ? 'granted' : 'denied',
                        'ad_personalization': window.publiiCBGCM.defaultState.ad_personalization ? 'granted' : 'denied',
                        'ad_user_data': window.publiiCBGCM.defaultState.ad_user_data ? 'granted' : 'denied',
                        'analytics_storage': window.publiiCBGCM.defaultState.analytics_storage ? 'granted' : 'denied',
                        'personalization_storage': window.publiiCBGCM.defaultState.personalization_storage ? 'granted' : 'denied',
                        'functionality_storage': window.publiiCBGCM.defaultState.functionality_storage ? 'granted' : 'denied',
                        'security_storage': window.publiiCBGCM.defaultState.security_storage ? 'granted' : 'denied'
                    }));
                }
            }

            showBanner();
        } else if (typeof currentConfig === 'string') {
            if (cbConfig.debugMode) {
                console.log('🍪 Config founded');
            }

            cbConfig.initialLsState = currentConfig.split(',');

            if (window.publiiCBGCM) {
                gtag('consent', 'default', {
                    'ad_storage': getDefaultConsentState(currentConfig, 'ad_storage'),
                    'ad_personalization': getDefaultConsentState(currentConfig, 'ad_personalization'),
                    'ad_user_data': getDefaultConsentState(currentConfig, 'ad_user_data'),
                    'analytics_storage': getDefaultConsentState(currentConfig, 'analytics_storage'),
                    'personalization_storage': getDefaultConsentState(currentConfig, 'personalization_storage'),
                    'functionality_storage': getDefaultConsentState(currentConfig, 'functionality_storage'),
                    'security_storage': getDefaultConsentState(currentConfig, 'security_storage')
                });
                
                if (cbConfig.debugMode) {
                    console.log('🍪 GCMv2 DEFAULT STATE: ' + JSON.stringify({
                        'ad_storage': getDefaultConsentState(currentConfig, 'ad_storage'),
                        'ad_personalization': getDefaultConsentState(currentConfig, 'ad_personalization'),
                        'ad_user_data': getDefaultConsentState(currentConfig, 'ad_user_data'),
                        'analytics_storage': getDefaultConsentState(currentConfig, 'analytics_storage'),
                        'personalization_storage': getDefaultConsentState(currentConfig, 'personalization_storage'),
                        'functionality_storage': getDefaultConsentState(currentConfig, 'functionality_storage'),
                        'security_storage': getDefaultConsentState(currentConfig, 'security_storage')
                    }));
                }
            }

            showBadge();

            if (cbUI.popup.element) {
                var allowedGroups = currentConfig.split(',');
                var checkedCheckboxes = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');

                for (var j = 0; j < checkedCheckboxes.length; j++) {
                    var name = checkedCheckboxes[j].getAttribute('data-group-name');

                    if (name && name !== '-' && allowedGroups.indexOf(name) === -1) {
                        checkedCheckboxes[j].checked = false;
                    }
                }

                for (var i = 0; i < allowedGroups.length; i++) {
                    var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + allowedGroups[i] + '"]');

                    if (checkbox) {
                        checkbox.checked = true;
                    }

                    allowCookieGroup(allowedGroups[i]);
                }
            }
        }

        setTimeout(function () {
            cbConfig.initialState = getInitialStateOfConsents();
        }, 0);
    }

    function checkIfConfigIsFresh () {
        var lastConfigSave = localStorage.getItem('publii-gdpr-cookies-config-save-date');

        if (lastConfigSave === null) {
            return false;
        }

        lastConfigSave = parseInt(lastConfigSave, 10);

        if (lastConfigSave === 0) {
            return true;
        }

        if (+new Date() - lastConfigSave < cbConfig.configTTL * 24 * 60 * 60 * 1000) {
            return true;
        }

        return false;
    }

    function getDefaultConsentState (currentConfig, consentGroup) {
        let configGroups = currentConfig.split(',');

        for (let i = 0; i < configGroups.length; i++) {
            let groupName = configGroups[i];
            let group = window.publiiCBGCM.groups.find(group => group.cookieGroup === groupName);

            if (group && group[consentGroup]) {
                return 'granted';
            }
        }  
        
        if (window.publiiCBGCM.defaultState[consentGroup]) {
            return 'granted'; 
        }
        
        return 'denied';
    }

    function initBannerEvents () {
        cbUI.banner.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('banner');
            showBadge();
        }, false);

        if (cbUI.banner.btnReject) {
            cbUI.banner.btnReject.addEventListener('click', function (e) {
                e.preventDefault();
                rejectAllCookies();
                showBadge();
            }, false);
        }

        if (cbUI.banner.btnConfigure) {
            cbUI.banner.btnConfigure.addEventListener('click', function (e) {
                e.preventDefault();
                hideBanner();
                showAdvancedPopup();
                showBadge();
            }, false);
        }
    }

    function initPopupEvents () {
        if (!cbUI.popup.element) {
            return;
        }

        cbUI.overlay.addEventListener('click', function (e) {
            hideAdvancedPopup();
        }, false);

        cbUI.popup.element.addEventListener('click', function (e) {
            e.stopPropagation();
        }, false);

        cbUI.popup.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('popup');
        }, false);

        cbUI.popup.btnReject.addEventListener('click', function (e) {
            e.preventDefault();
            rejectAllCookies();
        }, false);

        cbUI.popup.btnSave.addEventListener('click', function (e) {
            e.preventDefault();
            saveConfiguration();
        }, false);

        cbUI.popup.btnClose.addEventListener('click', function (e) {
            e.preventDefault();
            hideAdvancedPopup();
        }, false);
    }

    function initBadgeEvents () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.addEventListener('click', function (e) {
            showBannerOrPopup();
        }, false);
    }

    initUI();
    initState();
    initBannerEvents();
    initPopupEvents();
    initBadgeEvents();

    /**
     * API
     */
    function addScript (src, inline) {
        var newScript = document.createElement('script');

        if (src) {
            newScript.setAttribute('src', src);
        }

        if (inline) {
            newScript.text = inline;
        }

        document.body.appendChild(newScript);
    }

    function allowCookieGroup (allowedGroup) {
        var scripts = document.querySelectorAll('script[type="gdpr-blocker/' + allowedGroup + '"]');
        cbConfig.previouslyAccepted.push(allowedGroup);
    
        for (var j = 0; j < scripts.length; j++) {
            addScript(scripts[j].src, scripts[j].text);
        }

        var groupEvent = new Event('publii-cookie-banner-unblock-' + allowedGroup);
        document.body.dispatchEvent(groupEvent);
        unlockEmbeds(allowedGroup);

        if (cbConfig.debugMode) {
            console.log('🍪 Allowed group: ' + allowedGroup);
        }

        if (window.publiiCBGCM && (!cbConfig.initialLsState || cbConfig.initialLsState.indexOf(allowedGroup) === -1)) {
            let consentResult = {};
            let group = window.publiiCBGCM.groups.find(group => group.cookieGroup === allowedGroup);

            if (group) {
                let foundSomeConsents = false;

                Object.keys(group).forEach(key => {
                    if (key !== 'cookieGroup' && group[key] === true) {
                        consentResult[key] = 'granted';
                        foundSomeConsents = true;
                    }
                });

                if (foundSomeConsents) {
                    gtag('consent', 'update', consentResult);   

                    if (cbConfig.debugMode) {
                        console.log('🍪 GCMv2 UPDATE: ' + JSON.stringify(consentResult));
                    }
                }
            }
        }
    }

    function showBannerOrPopup () {
        if (cbUI.popup.element) {
            showAdvancedPopup();
        } else {
            showBanner();
        }
    }

    function showAdvancedPopup () {
        cbUI.popup.element.classList.add('is-visible');
        cbUI.overlay.classList.add('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'false');
        cbUI.overlay.setAttribute('aria-hidden', 'false');
    }

    function hideAdvancedPopup () {
        cbUI.popup.element.classList.remove('is-visible');
        cbUI.overlay.classList.remove('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'true');
        cbUI.overlay.setAttribute('aria-hidden', 'true');
    }

    function showBanner () {
        cbUI.banner.element.classList.add('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'false');
    }

    function hideBanner () {
        cbUI.banner.element.classList.remove('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'true');
    }

    function showBadge () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.classList.add('is-visible');
        cbUI.badge.setAttribute('aria-hidden', 'false');
    }

    function getConfigName () {
        var lsKeyName = 'publii-gdpr-allowed-cookies';

        if (cbConfig.revision) {
            lsKeyName = lsKeyName + '-v' + parseInt(cbConfig.revision, 10);
        }

        return lsKeyName;
    }

    function storeConfiguration (allowedGroups) {
        var lsKeyName = getConfigName();
        var dataToStore = allowedGroups.join(',');
        localStorage.setItem(lsKeyName, dataToStore);

        if (cbConfig.configTTL === 0) {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', 0);

            if (cbConfig.debugMode) {
                console.log('🍪 Store never expiring configuration');
            }
        } else {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', +new Date());
        }
    }

    function getInitialStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 Initial state: ' + groups.join(', '));
        }

        return groups;
    }

    function getCurrentStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 State to save: ' + groups.join(', '));
        }

        return groups;
    }

    function getAllGroups () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        return groups;
    }

    function acceptAllCookies (source) {
        var groupsToAccept = getAllGroups();
        storeConfiguration(groupsToAccept);

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        if (cbUI.popup.element) {
            var checkboxesToCheck = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');

            for (var j = 0; j < checkboxesToCheck.length; j++) {
                checkboxesToCheck[j].checked = true;
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 Accept all cookies: ', groupsToAccept.join(', '));
        }

        if (source === 'popup') {
            hideAdvancedPopup();
        } else if (source === 'banner') {
            hideBanner();
        }
    }

    function rejectAllCookies () {
        if (cbConfig.debugMode) {
            console.log('🍪 Reject all cookies');
        }

        storeConfiguration([]);
        setTimeout(function () {
            window.location.reload();
        }, 100);
    }

    function saveConfiguration () {
        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('🍪 Save new config: ', groupsToAccept.join(', '));
        }

        if (reloadIsNeeded(groupsToAccept)) {
            setTimeout(function () {
                window.location.reload();
            }, 100);
            return;
        }

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        hideAdvancedPopup();
    }

    function reloadIsNeeded (groupsToAccept) {
        // check if user rejected consent for initial groups
        var initialGroups = cbConfig.initialState;
        var previouslyAcceptedGroups = cbConfig.previouslyAccepted;
        var groupsToCheck = initialGroups.concat(previouslyAcceptedGroups);

        for (var i = 0; i < groupsToCheck.length; i++) {
            var groupToCheck = groupsToCheck[i];

            if (groupToCheck !== '' && groupsToAccept.indexOf(groupToCheck) === -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Reload is needed due lack of: ', groupToCheck);
                }

                return true;
            }
        }

        return false;
    }

    function unlockEmbeds (cookieGroup) {
        var iframesToUnlock = document.querySelectorAll('.pec-wrapper[data-consent-group-id="' + cookieGroup + '"]');

        for (var i = 0; i < iframesToUnlock.length; i++) {
            var iframeWrapper = iframesToUnlock[i];
            iframeWrapper.querySelector('.pec-overlay').classList.remove('is-active');
            iframeWrapper.querySelector('.pec-overlay').setAttribute('aria-hidden', 'true');
            var iframe = iframeWrapper.querySelector('iframe');
            iframe.setAttribute('src', iframe.getAttribute('data-consent-src'));
        }
    }

    win.publiiEmbedConsentGiven = function (cookieGroup) {
        // it will unlock embeds
        allowCookieGroup(cookieGroup);

        var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + cookieGroup + '"]');

        if (checkbox) {
            checkbox.checked = true;
        }

        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('🍪 Save new config: ', groupsToAccept.join(', '));
        }
    }
})(window);</script></body></html>